name: test_action
run-name: TEST ${{ join([github.ref_name, inputs.*], ', ') }}

on:
  workflow_dispatch:
    inputs:
      include-expression:
        description: 'Any string to be echoed...'
        required: false
        type: string
      pokus:
        required: false
        type: string
  push:

env:
  FOO: 'foo_bar'

jobs:
  print_event:
    if: github.event_name == 'workflow_dispatch'
    runs-on: ubuntu-latest
    steps:
      - run: |
          echo '${{ github.event.inputs.include-expression }}'
          echo ${{ github.ref }}
          echo $FOO

  start_reuse:
    if: github.event_name == 'workflow_dispatch'
    uses: ./.github/workflows/reuse_action.yml
    with:
      run-expression: '${{ github.event.inputs.include-expression }}'
    secrets:
      token: ${{ secrets.GITHUB_TOKEN }}

  start_reuse_on_push:
    if: github.event_name != 'workflow_dispatch'
    uses: ./.github/workflows/reuse_action.yml
    with:
      run-expression: Toto je pusteno na PUSH # - ${{ FOO }} # nefunguje, syntax error
      test_a: $FOO  # nefunguje, prazdna hodnota
#      test_b: ${{ FOO }} nefunguje, syntax error
    secrets:
      token: ${{ secrets.GITHUB_TOKEN }}
